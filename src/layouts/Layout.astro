---
interface Props {
  title?: string;
  showNav?: boolean;
}

const { title = 'Habit Build', showNav = true } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="description" content="Build lasting habits through daily check-ins and visual streak tracking" />
    <meta name="theme-color" content="#faf6f1" />
    
    <!-- Google Fonts - preconnect for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=Fraunces:ital,opsz,wght@0,9..144,400;0,9..144,500;0,9..144,600;0,9..144,700;1,9..144,400&display=swap" rel="stylesheet" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="/manifest.json" />
    
    <title>{title}</title>
  </head>
  <body>
    <main class="page">
      <slot />
    </main>
    
    {showNav && (
      <nav class="nav" aria-label="Main navigation">
        <a href="/" class="nav-item" data-page="home" aria-label="Today">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
          <span class="nav-label">Today</span>
        </a>
        <a href="/calendar" class="nav-item" data-page="calendar" aria-label="Calendar">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          <span class="nav-label">Calendar</span>
        </a>
        <a href="/history" class="nav-item" data-page="history" aria-label="History">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
          <span class="nav-label">History</span>
        </a>
        <a href="/friends" class="nav-item" data-page="friends" aria-label="Friends">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
          <span class="nav-label">Friends</span>
        </a>
        <a href="/settings" class="nav-item" data-page="settings" aria-label="Settings">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
          <span class="nav-label">Settings</span>
        </a>
      </nav>
    )}
    
    <script>
      // Highlight active nav item
      const currentPath = window.location.pathname;
      const navItems = document.querySelectorAll('.nav-item');
      
      navItems.forEach(item => {
        const href = item.getAttribute('href');
        const isActive = href === currentPath || 
          (href === '/' && currentPath === '/') ||
          (href !== '/' && currentPath.startsWith(href!));
        
        if (isActive) {
          item.classList.add('nav-item--active');
        }
      });
    </script>
  </body>
</html>

<style is:global>
  @import '../styles/global.css';
</style>

<style>
  /* Navigation Bar */
  .nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: space-around;
    align-items: center;
    background-color: var(--bg-card);
    border-top: 1px solid var(--border-light);
    padding: var(--space-2) 0;
    padding-bottom: calc(var(--space-2) + env(safe-area-inset-bottom));
    z-index: var(--z-dropdown);
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
  }
  
  .nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
    padding: var(--space-2) var(--space-3);
    color: var(--text-muted);
    text-decoration: none;
    transition: all var(--duration-fast) var(--ease-out);
    min-width: 56px;
    min-height: 52px;
    border-radius: var(--radius-md);
  }
  
  .nav-item:hover {
    color: var(--text-secondary);
    background-color: var(--bg-secondary);
  }
  
  .nav-item:active {
    transform: scale(0.95);
  }
  
  .nav-item--active {
    color: var(--accent-primary);
  }
  
  .nav-item--active .nav-icon {
    transform: scale(1.1);
  }
  
  .nav-icon {
    width: 22px;
    height: 22px;
    transition: transform var(--duration-fast) var(--ease-out);
  }
  
  .nav-label {
    font-size: 10px;
    font-weight: var(--font-medium);
    letter-spacing: 0.01em;
  }
  
  /* Smaller screens */
  @media (max-width: 380px) {
    .nav-item {
      min-width: 48px;
      padding: var(--space-2);
    }
    
    .nav-label {
      font-size: 9px;
    }
    
    .nav-icon {
      width: 20px;
      height: 20px;
    }
  }
</style>
